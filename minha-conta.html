<!DOCTYPE html><html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Minha Conta - MostreAki</title>
  <link rel="icon" href="favicon.ico" type="image/x-icon" />
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import {
      getFirestore,
      doc,
      setDoc,
      getDoc
    } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
    import {
      getAuth,
      onAuthStateChanged,
      signOut
    } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";const firebaseConfig = {
  apiKey: "AIzaSyBrKUtwP4T77oXE22cjOFVhfEUiJ7yctIE",
  authDomain: "mostreaki-2025.firebaseapp.com",
  projectId: "mostreaki-2025",
  storageBucket: "mostreaki-2025.appspot.com",
  messagingSenderId: "748712068097",
  appId: "1:748712068097:web:09cf043fbb45917ef6ec00"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const auth = getAuth(app);

function atualizarUserCircle(foto) {
  const circle = document.getElementById("userCircle");
  circle.innerHTML = "";
  if (foto) {
    const img = document.createElement("img");
    img.src = foto;
    img.alt = "Foto de Perfil";
    circle.appendChild(img);
  } else {
    const email = localStorage.getItem("email") || "U";
    circle.textContent = email.charAt(0).toUpperCase();
  }
}

function previewImagem(event) {
  const file = event.target.files[0];
  if (file) {
    const reader = new FileReader();
    reader.onload = function (e) {
      const src = e.target.result;
      document.getElementById("fotoPreview").src = src;
      localStorage.setItem("fotoPerfil", src);
      atualizarUserCircle(src);
    };
    reader.readAsDataURL(file);
  }
}

async function salvarDados() {
  const user = auth.currentUser;
  if (!user) return;
  const uid = user.uid;
  const docRef = doc(db, "usuarios", uid);

  await setDoc(docRef, {
    instagram: document.getElementById("instagram").value,
    facebook: document.getElementById("facebook").value,
    whatsapp: document.getElementById("whatsapp").value,
    youtube: document.getElementById("youtube").value,
    foto: localStorage.getItem("fotoPerfil") || null
  });

  alert("Dados salvos com sucesso!");
}

async function carregarDados(user) {
  const docRef = doc(db, "usuarios", user.uid);
  const snap = await getDoc(docRef);
  if (snap.exists()) {
    const dados = snap.data();
    document.getElementById("instagram").value = dados.instagram || "";
    document.getElementById("facebook").value = dados.facebook || "";
    document.getElementById("whatsapp").value = dados.whatsapp || "";
    document.getElementById("youtube").value = dados.youtube || "";

    const foto = dados.foto;
    if (foto) {
      document.getElementById("fotoPreview").src = foto;
      localStorage.setItem("fotoPerfil", foto);
      atualizarUserCircle(foto);
    }
  }
}

function logout() {
  signOut(auth).then(() => {
    localStorage.clear();
    alert("Você saiu da conta.");
    window.location.href = "/index.html";
  });
}

window.logout = logout;
window.previewImagem = previewImagem;
window.salvarDados = salvarDados;

onAuthStateChanged(auth, (user) => {
  const authText = document.getElementById("authText");
  const userCircle = document.getElementById("userCircle");

  if (user) {
    authText.textContent = "Sair";
    authText.style.display = "inline";
    userCircle.style.display = "flex";
    carregarDados(user);
  } else {
    authText.textContent = "Entrar";
    authText.style.display = "inline";
    userCircle.style.display = "none";
  }
});

  </script>
  <style>
    /* Seu CSS mantido como antes */
  </style>
</head>
<body>
  <!-- HTML mantido como no modelo anterior (header, menu, formulário...) -->
  <!-- Certifique-se de que IDs estão corretos: authText, userCircle, fotoPreview, etc -->
</body>
</html>
